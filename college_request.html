<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>طلب دخول الكلية</title>
  <style>
    body {
      font-family: "Tajawal", Arial, sans-serif;
      margin: 0;
      padding: 0;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background: linear-gradient(135deg, #0d47a1, #1565c0, #1e88e5);
      color: white;
    }

    .form-container {
      background-color: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(12px);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 18px;
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.4);
      padding: 40px 30px;
      width: 400px;
      text-align: right;
    }

    h2 {
      text-align: center;
      color: #fff;
      margin-bottom: 25px;
      text-shadow: 0 0 6px rgba(0,0,0,0.4);
    }

    .input-group {
      margin-bottom: 18px;
    }

    label {
      display: block;
      font-weight: bold;
      margin-bottom: 6px;
      color: #fff;
    }

    input {
      width: 100%;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid rgba(255,255,255,0.5);
      background-color: rgba(255,255,255,0.2);
      color: #fff;
      font-size: 15px;
      transition: 0.3s;
    }

    input:focus {
      outline: none;
      border-color: #22bace;
      box-shadow: 0 0 6px rgba(34,186,206,0.6);
      background-color: rgba(255,255,255,0.3);
    }

    input::placeholder {
      color: rgba(255,255,255,0.8);
    }

    button {
      background-color: #22bace;
      color: white;
      border: none;
      padding: 12px 0;
      width: 100%;
      font-size: 17px;
      border-radius: 8px;
      cursor: pointer;
      transition: 0.3s;
      margin-top: 10px;
    }

    button:hover {
      background-color: #1aa4b5;
      transform: translateY(-2px);
    }

    @media (max-width: 500px) {
      .form-container {
        width: 90%;
        padding: 25px 20px;
      }
    }
  </style>
</head>
<body>

  <div class="form-container">
    <h2>طلب دخول الكلية</h2>

    <!-- يرسل الطلب إلى PHP -->
    <form action="../PHP/save_entry.php" method="POST" onsubmit="return validateForm()">
      <div class="input-group">
        <label for="name">الاسم الكامل</label>
        <input type="text" id="name" name="full_name" required placeholder="أدخل اسمك الكامل">
      </div>

      <div class="input-group">
        <label for="id">الرقم الأكاديمي</label>
        <input type="text" id="id" name="academic_id" required placeholder="أدخل رقمك الأكاديمي">
      </div>

      <div class="input-group">
        <label for="phone">رقم الجوال</label>
        <input type="tel" id="phone" name="phone" required placeholder="05xxxxxxxx">
      </div>

      <div class="input-group">
        <label for="in-date">تاريخ ووقت الدخول</label>
        <input type="datetime-local" id="in-date" name="in_datetime" required>
      </div>

      <div class="input-group">
        <label for="out-date">تاريخ ووقت الخروج</label>
        <input type="datetime-local" id="out-date" name="out_datetime" required>
      </div>

      <div class="input-group">
        <label for="supervisor">مشرف المادة</label>
        <input type="text" id="supervisor" name="supervisor" required placeholder="أدخل اسم المشرف">
      </div>

      <button type="submit">إرسال طلب الدخول</button>
    </form>
  </div>

  <script>
    // ضبط وقت الدخول تلقائياً عند فتح الصفحة (الحد الأدنى 4 مساءً)
    window.onload = function() {
      const now = new Date();
      const year = now.getFullYear();
      const month = String(now.getMonth() + 1).padStart(2, '0');
      const day = String(now.getDate()).padStart(2, '0');
      const hour = now.getHours();
      const minute = String(now.getMinutes()).padStart(2, '0');

      // إذا الوقت أقل من 4 العصر، نخليه 4:xx
      const adjustedHour = hour < 16 ? 16 : hour;
      const formattedDate = `${year}-${month}-${day}T${String(adjustedHour).padStart(2, '0')}:${minute}`;
      document.getElementById("in-date").value = formattedDate;
    };

    // السماح فقط بين 4:00 مساءً إلى 10:59 مساءً
    function isWithinAllowedHours(dateTimeStr) {
      const date = new Date(dateTimeStr);
      const hour = date.getHours();
      return hour >= 16 && hour < 23; // من 4 م إلى قبل 11 م
    }

    function validateForm() {
      const name = document.getElementById("name").value.trim();
      const id = document.getElementById("id").value.trim();
      const phone = document.getElementById("phone").value.trim();
      const inDate = document.getElementById("in-date").value;
      const outDate = document.getElementById("out-date").value;
      const supervisor = document.getElementById("supervisor").value.trim();

      if (!name || !id || !phone || !inDate || !outDate || !supervisor) {
        alert("❌ يرجى تعبئة جميع الحقول");
        return false;
      }

      if (!isWithinAllowedHours(inDate) || !isWithinAllowedHours(outDate)) {
        alert("⚠️ يسمح بالطلبات فقط بين الساعة 4:00 مساءً و 10:59 مساءً");
        return false;
      }

      alert(`✅ تم إرسال طلب الدخول بنجاح، بانتظار موافقة الإدارة`);
      return true; // مهم عشان يرسل الطلب إلى save_entry.php
    }
  </script>

</body>
</html>
